import{createPostElement}from"./post-utils.js";const POSTS_PER_PAGE=10;let postsContainer,paginationContainer,allPosts=[],currentPage=1;function displayPage(e){currentPage=e,postsContainer.innerHTML="";const n=document.createDocumentFragment(),t=10*(e-1),a=t+10;allPosts.slice(t,a).forEach(e=>{const t=document.createElement("hr");t.className="post-separator",n.appendChild(t);const a=createPostElement(e,"/content/blog/posts/");n.appendChild(a)}),postsContainer.appendChild(n),renderPagination(),window.scrollTo(0,0)}function createPaginationItem(e,n,t=!1,a=!1){const o=document.createElement("li");o.className="page-item",t&&o.classList.add("disabled"),a&&o.classList.add("active");const i=document.createElement("a");return i.className="page-link",i.href="#",i.textContent=e,i.addEventListener("click",e=>{e.preventDefault(),t||displayPage(n)}),o.appendChild(i),o}function renderPagination(){paginationContainer.innerHTML="";const e=Math.ceil(allPosts.length/10);if(e<=1)return;const n=document.createElement("ul");n.className="pagination",n.appendChild(createPaginationItem("«",currentPage-1,1===currentPage));for(let t=1;t<=e;t++)n.appendChild(createPaginationItem(t.toString(),t,!1,t===currentPage));n.appendChild(createPaginationItem("»",currentPage+1,currentPage===e)),paginationContainer.appendChild(n)}export async function initializePaginatedBlog(){if(postsContainer=document.getElementById("blog-posts-container"),paginationContainer=document.getElementById("pagination-container"),postsContainer&&paginationContainer)try{const e="/content/blog/posts-manifest.json",n=await fetch(e);if(!n.ok)throw new Error(`Failed to fetch posts manifest from ${e}: ${n.statusText}`);const t=await n.json();if(allPosts=t.filter(e=>e.publicationDate).sort((e,n)=>new Date(n.publicationDate)-new Date(e.publicationDate)),0===allPosts.length)return void(postsContainer.innerHTML="<p>No hay publicaciones disponibles en este momento.</p>");displayPage(1)}catch(e){console.error("Error al inicializar la página del blog:",e),postsContainer.innerHTML='<p class="error-message">No se pudieron cargar las entradas del blog. Por favor, inténtalo de nuevo más tarde.</p>'}else console.error("No se encontraron los contenedores necesarios para el blog (#blog-posts-container, #pagination-container).")}