function createFieldElement(e){if("table"===e.tipo)return createTableField(e);if("checkbox-group"===e.tipo)return createCheckboxGroup(e);const t=document.createElement("div");t.className="form-field";const n=document.createElement("label");n.htmlFor=e.id,n.textContent=e.etiqueta,t.appendChild(n);const a=document.createElement("div");let o;switch(a.className="input-wrapper",e.tipo){case"textarea":o=document.createElement("textarea"),e.filas&&(o.rows=e.filas);break;case"select":o=document.createElement("select"),e.opciones&&e.opciones.forEach(e=>{const t=document.createElement("option");t.value=e.valor,t.textContent=e.texto,e.disabled&&(t.disabled=!0),e.selected&&(t.selected=!0),o.appendChild(t)});break;default:o=document.createElement("input"),o.type=e.tipo||"text"}if(o.id=e.id,o.name=e.id,e.placeholder&&(o.placeholder=e.placeholder),e.requerido&&(o.required=!0),a.appendChild(o),e.tooltip){const t=document.createElement("div");t.className="tooltip";const n=document.createElement("i");n.className="tooltip-icon",n.tabIndex=0,n.textContent="i";const o=document.createElement("span");o.className="tooltip-text",o.textContent=e.tooltip,t.appendChild(n),t.appendChild(o),a.appendChild(t)}return t.appendChild(a),t}export function renderFormFromJSON(e,t){t.innerHTML="";const n=document.createElement("form");n.className="prompt-form",n.id=e.id,n.noValidate=!0,e.plantilla_prompt&&(n.dataset.promptTemplate=e.plantilla_prompt);const a=document.createDocumentFragment();e.campos.forEach(e=>{a.appendChild(createFieldElement(e))}),n.appendChild(a),t.appendChild(n)}function createTableField(e){const t=document.createElement("div");t.className="form-field";const n=document.createElement("label");n.textContent=e.etiqueta,t.appendChild(n);const a=document.createElement("div");a.className="input-wrapper";const o=document.createElement("div");o.className="table-control-container";const c=document.createElement("table");c.id=e.id,c.className="dynamic-table";const l=c.createTHead().insertRow();e.columnas.forEach(e=>{const t=document.createElement("th");t.textContent=e.etiqueta,l.appendChild(t)});const d=document.createElement("th");d.textContent="Acción",l.appendChild(d);const i=c.createTBody();addTableRow(i,e.id,e.columnas),o.appendChild(c);const r=document.createElement("button");if(r.type="button",r.textContent=e.texto_boton_anadir||"Añadir Fila",r.className="btn add-row-btn",r.addEventListener("click",()=>addTableRow(i,e.id,e.columnas)),o.appendChild(r),a.appendChild(o),e.tooltip){const t=document.createElement("div");t.className="tooltip";const n=document.createElement("i");n.className="tooltip-icon",n.tabIndex=0,n.textContent="i";const o=document.createElement("span");o.className="tooltip-text",o.textContent=e.tooltip,t.appendChild(n),t.appendChild(o),a.appendChild(t)}return t.appendChild(a),t}function addTableRow(e,t,n){const a=e.insertRow();n.forEach(e=>{const t=a.insertCell();let n;if("checkbox"===e.tipo)n=document.createElement("input"),n.type="checkbox";else n=document.createElement("input"),n.type="text",n.placeholder=e.placeholder||"";n.dataset.columnId=e.id,e.requerido&&(n.required=!0),t.appendChild(n)});const o=a.insertCell(),c=document.createElement("button");c.type="button",c.innerHTML="&times;",c.className="remove-row-btn",c.title="Eliminar fila",c.addEventListener("click",()=>{e.rows.length>1&&a.remove()}),o.appendChild(c)}function createCheckboxGroup(e){const t=document.createElement("div");t.className="form-field";const n=document.createElement("fieldset"),a=document.createElement("legend");return a.className="form-label",a.textContent=e.etiqueta,n.appendChild(a),e.opciones.forEach(t=>{const a=document.createElement("div");a.className="checkbox-option";const o=document.createElement("input");o.type="checkbox",o.id=`${e.id}-${t.valor.replace(/\s+/g,"-")}`,o.name=e.id,o.value=t.valor,t.checked&&(o.checked=!0);const c=document.createElement("label");c.htmlFor=o.id,c.textContent=t.texto,a.append(o,c),n.appendChild(a)}),t.appendChild(n),t}